#!/bin/bash

echo "ğŸ”§ Flask/HTML ê²½ë¡œ ìë™ ìƒëŒ€í™” ì‘ì—… ì‹œì‘!"

TARGET_DIR="./challenges"

find "$TARGET_DIR" -type f \( -name "*.py" -o -name "*.html" \) | while read -r file; do
    echo "ğŸ“„ ìˆ˜ì • ì¤‘: $file"

    # ë°±ì—…
    cp "$file" "$file.bak"

    # ì •ê·œì‹ ê¸°ë°˜ sed ìˆ˜ì •
    sed -i \
        -E 's|href="/([^"]+)"|href="\1"|g' \
        -E "s|href='/([^']+)'|href='\1'|g" \
        -E 's|action="/([^"]+)"|action="\1"|g' \
        -E "s|action='/([^']+)'|action='\1'|g" \
        -E 's|src="/([^"]+\.png)"|src="\1"|g' \
        -E "s|src='/([^']+\.png)'|src='\1'|g" \
        -E "s|url_for\('static', filename='([^']+\.png)'\)|'static/\1'|g" \
        "$file"

    echo "âœ… ì™„ë£Œ!"
done

echo "ğŸ‰ ëª¨ë“  ê²½ë¡œë¥¼ ìƒëŒ€ê²½ë¡œë¡œ ë°”ê¿¨ìŠµë‹ˆë‹¤!"
